<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Super Mario 64 Source: README</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Super Mario 64 Source
   </div>
   <div id="projectbrief">A Super Mario 64 decompilation, brought to you by a bunch of clever folks.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="../../dc/d7c/structSound.html">Sound</a> in SM64 consists of three parts: samples, sound banks, and sequences.</p>
<p>Samples represent raw sound data, given as AIFF files with a custom ADPCM-based compression format that reduces file sizes by ~70% compared to uncompressed AIFF (with 16-bit samples). The build system automatically converts uncompressed AIFF files into this format.</p>
<p>Samples are collected into banks, given by directories. The order in which banks and samples end up in the final binary is determined by their file and directory names. Thus, to keep the ROM OK, sample files/bank directories should be prefixed by a number to maintain sort order.</p>
<p>Samples cannot be referred to directly from sequence files. Instead, there is an indirect step in the form of sound banks. Each sound bank refers to a single sample bank, and amends it with extra information in the form of a JSON file. This JSON file contains a set of "instruments", which describe how note values (pitches) map to samples, which pitch corrections to perform, and what ADSR envelopes to use. The <code>instrument_list</code> key maps indices to instruments; these indices are what sequence files can refer to. A special instrument <code>percussion</code> is also supported, as an array with (usually) 64 different entries, covering note values 0..63. It is referred to as instrument ID 0x7f.</p>
<p>C-style comments are supported in the JSON. Similar to samples, the sound banks come in alphabetical order in the ROM, so they should be prefixed to maintain sort order.</p>
<p>Sequence files are what actually controls the audio. The are in .m64 format, which is similar to MIDI, but Turing complete. An .m64 file has a sequence script that can spawn channels, which have channel scripts that can spawn layers, which have layer scripts that can play notes. Each note is performed using an instrument from a sound bank. A sequence file can use multiple banks; <code>bank_sets.s</code> describes the mapping from sequences to sound banks. Channels can switch between banks using a command. However, in practice most sequences limit themselves to a single sound bank. The main exception is sequence 0, which is responsible for sound effects.</p>
<p>Like samples and sound banks, sequence files are included in the ROM in alphabetical file name order. They can be located in either <code>sound/sequences/</code> or <code>sound/sequences/&lt;version&gt;/</code>, and can optionally be given in disassembled form &ndash; see <code><a class="el" href="../../d6/dd2/seq__macros_8inc.html">include/seq_macros.inc</a></code> for more details on the format.</p>
<p>The repo gitignores .m64 and .aiff files by default, unless they include "custom" somewhere in the name (including in a directory name). Thus, for new custom-made samples and sequences it is advisable to include that substring in the file name (this also helps distinguish custom sounds from ones from the game). <code>git add -f</code> also works for adding edited existing files to git. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
